\documentclass[12pt, danish]{beamer}

\usepackage[danish]{babel}
\usepackage[utf8x]{inputenc}
\usepackage{graphics}
\usepackage{srcltx}
\usepackage{float}
\usepackage{layout}
\usepackage{listings}

\title{Topics in Programming Languages}
\author{Jep}

% \usetheme[nat, dogma]{Frederiksberg}

\def\height{0.6\paperheight}
\def\width{0.9\linewidth}

\setlength{\marginparwidth}{1pt}
\setlength{\hoffset}{1pt}

\begin{document}

\begin{frame}
\maketitle
\end{frame}

\begin{frame}
Noget\pause{} om\pause{} EDI
\end{frame}

\begin{frame}
Noget\pause{} om\pause{} monad-par
\end{frame}

\begin{frame}
  \frametitle{Par Monad}
  Par can be used for specifying \textbf{pure parallel computations} in which the order of the computation is not known beforehand. \newline
  
  The programmer specifies how \textbf{information flows} from one part of the computation to another, but not the order in which computations will be evaluated at runtime. Information flow is described using variables called \texttt{IVars}, which support \texttt{put} and \texttt{get} operations. \newline 
  
\texttt{http://hackage.haskell.org/packages/archive/monad-par/0.1.0.1/doc/html/Control-Monad-Par.html}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Par Monad - Par}
  \begin{lstlisting}[language=Haskell]
runPar :: Par a -> a
fork :: Par () -> Par ()
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Par Monad - IVar}
  \begin{lstlisting}[language=Haskell]
new :: Par (IVar a)
get :: IVar a -> Par a
put :: NFData a => IVar a -> a -> Par ()
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Par Monad - IVar}
  \begin{lstlisting}[language=Haskell]
get :: IVar a -> Par a  
  \end{lstlisting}

  Read the value in a IVar. The get can only return when the value 
  has been written by a prior or parallel put to the same IVar.
\end{frame}

\begin{frame}[fragile]
  \frametitle{Par Monad - IVar}
  \begin{lstlisting}[language=Haskell]
put :: NFData a => IVar a -> a -> Par ()
  \end{lstlisting} 
    
  Put a value into a IVar. \textbf{Multiple puts} to the same IVar \textbf{are not 
    allowed}, and result in a runtime error.
\end{frame}

\begin{frame}[fragile]
  \frametitle{Par Monad - Example}
  \begin{lstlisting}[language=Haskell]
                      a
                     / \  
                    b   c
                     \ /
                      d
  
runPar $ do
       [a,b,c,d] <- sequence [new,new,new,new]
       fork $ do x <- get a; put b (x+1)
       fork $ do x <- get a; put c (x+2)
       fork $ do x <- get b
                 y <- get c 
                 put d (x+y)
       fork $ do put a (3 :: Int)
       get d
  \end{lstlisting}
\end{frame}

\end{document}
